{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import'./css/downloadticket.css';import title from'./css/Image/grsrtc.png';import axios from'axios';import{Link}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function DownloadTicket(){const[,setName]=useState('');const[details,setDetails]=useState(null);// const navigate = useNavigate();\nconst[formData,setFormData]=useState({id:'',busNo:'',busName:'',service:'',mode:'',to:'',from:'',time:'',date:'',name:'',age:'',gender:'',mobileNo:'',seatNo:'',totalPrice:''});useEffect(()=>{const storedBus=JSON.parse(localStorage.getItem('selectedBus'));if(storedBus){setFormData(prevState=>({...prevState,busNo:storedBus.busno,busName:storedBus.busname,service:storedBus.service,mode:storedBus.mode,time:storedBus.time// Set other properties as needed\n}));}},[]);useEffect(()=>{const storedName=localStorage.getItem(\"name\");const storedPrice=localStorage.getItem(\"totalPrice\");if(storedName){setName(storedName);fetchLastInsertedPassenger();}if(storedPrice){setFormData(prevState=>({...prevState,totalPrice:storedPrice}));}},[]);const fetchLastInsertedPassenger=()=>{axios.get('http://localhost:3001/last-passenger').then(res=>setDetails(res.data)).catch(err=>console.error(\"Error fetching passenger details:\",err));};const handleSubmit=e=>{e.preventDefault();// Insert new passenger data\naxios.post('http://localhost:3001/insert',formData).then(()=>{fetchLastInsertedPassenger();setFormData({id:'',busNo:formData.busNo,busName:formData.busName,service:formData.service,mode:formData.mode,to:formData.to,from:formData.from,time:formData.time,date:'',name:'',age:'',gender:'',mobileNo:'',seatNo:'',totalPrice:''});// alert(\"HAPPY JOURNEY....\");\n// navigate(\"/home\")\n}).catch(err=>console.error(\"Error submitting passenger data:\",err));};return/*#__PURE__*/_jsxs(\"div\",{className:\"download-ticket\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"dt\",children:\"GSRTC TICKET\"}),/*#__PURE__*/_jsx(\"img\",{className:\"ti\",src:title,alt:\"title\"})]}),details?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"PNR NUMBER\"}),/*#__PURE__*/_jsx(\"th\",{children:\"BUS NO\"}),/*#__PURE__*/_jsx(\"th\",{children:\"BUS NAME\"}),/*#__PURE__*/_jsx(\"th\",{children:\"SERVICE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"MODE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"From\"}),/*#__PURE__*/_jsx(\"th\",{children:\"To\"}),/*#__PURE__*/_jsx(\"th\",{children:\"TIME\"}),/*#__PURE__*/_jsx(\"th\",{children:\"DATE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"NAME\"}),/*#__PURE__*/_jsx(\"th\",{children:\"AGE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"GENDER\"}),/*#__PURE__*/_jsx(\"th\",{children:\"MOBILE NO\"}),/*#__PURE__*/_jsx(\"th\",{children:\"SEAT NO\"}),/*#__PURE__*/_jsx(\"th\",{children:\"TOTAL PRICE\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:details.id}),/*#__PURE__*/_jsx(\"td\",{children:formData.busNo}),/*#__PURE__*/_jsx(\"td\",{children:formData.busName}),/*#__PURE__*/_jsx(\"td\",{children:formData.service}),/*#__PURE__*/_jsx(\"td\",{children:formData.mode}),/*#__PURE__*/_jsx(\"td\",{children:details.from}),/*#__PURE__*/_jsx(\"td\",{children:details.to}),/*#__PURE__*/_jsx(\"td\",{children:formData.time}),/*#__PURE__*/_jsx(\"td\",{children:details.date}),/*#__PURE__*/_jsx(\"td\",{children:details.name}),/*#__PURE__*/_jsx(\"td\",{children:details.age}),/*#__PURE__*/_jsx(\"td\",{children:details.gender}),/*#__PURE__*/_jsx(\"td\",{children:details.number}),/*#__PURE__*/_jsx(\"td\",{children:details.seat}),/*#__PURE__*/_jsx(\"td\",{children:formData.totalPrice})]})})]}),/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"button\",{class:\"button type1\",onClick:()=>window.print()})})]}):/*#__PURE__*/_jsx(\"h1\",{children:\"Loading...\"})]});}export default DownloadTicket;","map":{"version":3,"names":["React","useEffect","useState","title","axios","Link","jsx","_jsx","jsxs","_jsxs","DownloadTicket","setName","details","setDetails","formData","setFormData","id","busNo","busName","service","mode","to","from","time","date","name","age","gender","mobileNo","seatNo","totalPrice","storedBus","JSON","parse","localStorage","getItem","prevState","busno","busname","storedName","storedPrice","fetchLastInsertedPassenger","get","then","res","data","catch","err","console","error","handleSubmit","e","preventDefault","post","className","children","src","alt","onSubmit","number","seat","class","onClick","window","print"],"sources":["D:/bus booking system/client/src/components/Downloadticket.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport './css/downloadticket.css';\r\nimport title from './css/Image/grsrtc.png';\r\nimport axios from 'axios';\r\nimport { Link } from \"react-router-dom\";\r\nfunction DownloadTicket() {\r\n    const [, setName] = useState('');\r\n    const [details, setDetails] = useState(null);\r\n    // const navigate = useNavigate();\r\n\r\n    const [formData, setFormData] = useState({\r\n        id: '',\r\n        busNo: '',\r\n        busName: '',\r\n        service: '',\r\n        mode: '',\r\n        to: '',\r\n        from: '',\r\n        time: '',\r\n        date: '',\r\n        name: '',\r\n        age: '',\r\n        gender: '',\r\n        mobileNo: '',\r\n        seatNo: '',\r\n        totalPrice: ''\r\n    });\r\n\r\n    useEffect(() => {\r\n        const storedBus = JSON.parse(localStorage.getItem('selectedBus'));\r\n        if (storedBus) {\r\n            setFormData(prevState => ({\r\n                ...prevState,\r\n                busNo: storedBus.busno,\r\n                busName: storedBus.busname,\r\n                service: storedBus.service,\r\n                mode: storedBus.mode,\r\n                time: storedBus.time,\r\n                // Set other properties as needed\r\n            }));\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const storedName = localStorage.getItem(\"name\");\r\n        const storedPrice = localStorage.getItem(\"totalPrice\");\r\n        if (storedName) {\r\n            setName(storedName);\r\n            fetchLastInsertedPassenger();\r\n        }\r\n        if (storedPrice) {\r\n            setFormData(prevState => ({\r\n                ...prevState,\r\n                totalPrice: storedPrice\r\n            }));\r\n        }\r\n    }, []);\r\n\r\n    const fetchLastInsertedPassenger = () => {\r\n        axios.get('http://localhost:3001/last-passenger')\r\n            .then(res => setDetails(res.data))\r\n            .catch(err => console.error(\"Error fetching passenger details:\", err));\r\n    };\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        // Insert new passenger data\r\n        axios.post('http://localhost:3001/insert', formData)\r\n            .then(() => {\r\n                fetchLastInsertedPassenger();\r\n                setFormData({ \r\n                    id: '',\r\n                    busNo: formData.busNo,\r\n                    busName: formData.busName,\r\n                    service: formData.service,\r\n                    mode: formData.mode,\r\n                    to: formData.to,\r\n                    from: formData.from,\r\n                    time: formData.time,\r\n                    date: '',\r\n                    name: '',\r\n                    age: '',\r\n                    gender: '',\r\n                    mobileNo: '',\r\n                    seatNo: '',\r\n                    totalPrice: ''\r\n                });\r\n                // alert(\"HAPPY JOURNEY....\");\r\n                // navigate(\"/home\")\r\n            })\r\n            .catch(err => console.error(\"Error submitting passenger data:\", err));\r\n    };\r\n\r\n    return (\r\n        <div className=\"download-ticket\">\r\n            <div>\r\n                <h1 className=\"dt\">GSRTC TICKET</h1>\r\n                <img className=\"ti\" src={title} alt=\"title\" />\r\n            </div>\r\n\r\n            {details ? (\r\n                <form onSubmit={handleSubmit}>\r\n                    <table className=\"table\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>PNR NUMBER</th>\r\n                                <th>BUS NO</th>\r\n                                <th>BUS NAME</th>\r\n                                <th>SERVICE</th>\r\n                                <th>MODE</th>\r\n                                <th>From</th>\r\n                                <th>To</th>\r\n                                <th>TIME</th>\r\n                                <th>DATE</th>\r\n                                <th>NAME</th>\r\n                                <th>AGE</th>\r\n                                <th>GENDER</th>\r\n                                <th>MOBILE NO</th>\r\n                                <th>SEAT NO</th>\r\n                                <th>TOTAL PRICE</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr>\r\n                                <td>{details.id}</td>\r\n                                <td>{formData.busNo}</td>\r\n                                <td>{formData.busName}</td>\r\n                                <td>{formData.service}</td>\r\n                                <td>{formData.mode}</td>\r\n                                <td>{details.from}</td>\r\n                                <td>{details.to}</td>\r\n                                <td>{formData.time}</td>\r\n                                <td>{details.date}</td>\r\n                                <td>{details.name}</td>\r\n                                <td>{details.age}</td>\r\n                                <td>{details.gender}</td>\r\n                                <td>{details.number}</td>\r\n                                <td>{details.seat}</td>\r\n                                <td>{formData.totalPrice}</td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                    \r\n                    <Link to=\"/\"><button class=\"button type1\" onClick={() => window.print()}>\r\n                    </button></Link>\r\n                    \r\n                    \r\n                </form>\r\n            ) : (\r\n                <h1>Loading...</h1>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default DownloadTicket;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,0BAA0B,CACjC,MAAO,CAAAC,KAAK,KAAM,wBAAwB,CAC1C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,IAAI,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBACxC,QAAS,CAAAC,cAAcA,CAAA,CAAG,CACtB,KAAM,EAAGC,OAAO,CAAC,CAAGT,QAAQ,CAAC,EAAE,CAAC,CAChC,KAAM,CAACU,OAAO,CAAEC,UAAU,CAAC,CAAGX,QAAQ,CAAC,IAAI,CAAC,CAC5C;AAEA,KAAM,CAACY,QAAQ,CAAEC,WAAW,CAAC,CAAGb,QAAQ,CAAC,CACrCc,EAAE,CAAE,EAAE,CACNC,KAAK,CAAE,EAAE,CACTC,OAAO,CAAE,EAAE,CACXC,OAAO,CAAE,EAAE,CACXC,IAAI,CAAE,EAAE,CACRC,EAAE,CAAE,EAAE,CACNC,IAAI,CAAE,EAAE,CACRC,IAAI,CAAE,EAAE,CACRC,IAAI,CAAE,EAAE,CACRC,IAAI,CAAE,EAAE,CACRC,GAAG,CAAE,EAAE,CACPC,MAAM,CAAE,EAAE,CACVC,QAAQ,CAAE,EAAE,CACZC,MAAM,CAAE,EAAE,CACVC,UAAU,CAAE,EAChB,CAAC,CAAC,CAEF7B,SAAS,CAAC,IAAM,CACZ,KAAM,CAAA8B,SAAS,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC,CAAC,CACjE,GAAIJ,SAAS,CAAE,CACXhB,WAAW,CAACqB,SAAS,GAAK,CACtB,GAAGA,SAAS,CACZnB,KAAK,CAAEc,SAAS,CAACM,KAAK,CACtBnB,OAAO,CAAEa,SAAS,CAACO,OAAO,CAC1BnB,OAAO,CAAEY,SAAS,CAACZ,OAAO,CAC1BC,IAAI,CAAEW,SAAS,CAACX,IAAI,CACpBG,IAAI,CAAEQ,SAAS,CAACR,IAChB;AACJ,CAAC,CAAC,CAAC,CACP,CACJ,CAAC,CAAE,EAAE,CAAC,CAENtB,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAsC,UAAU,CAAGL,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAC/C,KAAM,CAAAK,WAAW,CAAGN,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CACtD,GAAII,UAAU,CAAE,CACZ5B,OAAO,CAAC4B,UAAU,CAAC,CACnBE,0BAA0B,CAAC,CAAC,CAChC,CACA,GAAID,WAAW,CAAE,CACbzB,WAAW,CAACqB,SAAS,GAAK,CACtB,GAAGA,SAAS,CACZN,UAAU,CAAEU,WAChB,CAAC,CAAC,CAAC,CACP,CACJ,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,0BAA0B,CAAGA,CAAA,GAAM,CACrCrC,KAAK,CAACsC,GAAG,CAAC,sCAAsC,CAAC,CAC5CC,IAAI,CAACC,GAAG,EAAI/B,UAAU,CAAC+B,GAAG,CAACC,IAAI,CAAC,CAAC,CACjCC,KAAK,CAACC,GAAG,EAAIC,OAAO,CAACC,KAAK,CAAC,mCAAmC,CAAEF,GAAG,CAAC,CAAC,CAC9E,CAAC,CAED,KAAM,CAAAG,YAAY,CAAIC,CAAC,EAAK,CACxBA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB;AACAhD,KAAK,CAACiD,IAAI,CAAC,8BAA8B,CAAEvC,QAAQ,CAAC,CAC/C6B,IAAI,CAAC,IAAM,CACRF,0BAA0B,CAAC,CAAC,CAC5B1B,WAAW,CAAC,CACRC,EAAE,CAAE,EAAE,CACNC,KAAK,CAAEH,QAAQ,CAACG,KAAK,CACrBC,OAAO,CAAEJ,QAAQ,CAACI,OAAO,CACzBC,OAAO,CAAEL,QAAQ,CAACK,OAAO,CACzBC,IAAI,CAAEN,QAAQ,CAACM,IAAI,CACnBC,EAAE,CAAEP,QAAQ,CAACO,EAAE,CACfC,IAAI,CAAER,QAAQ,CAACQ,IAAI,CACnBC,IAAI,CAAET,QAAQ,CAACS,IAAI,CACnBC,IAAI,CAAE,EAAE,CACRC,IAAI,CAAE,EAAE,CACRC,GAAG,CAAE,EAAE,CACPC,MAAM,CAAE,EAAE,CACVC,QAAQ,CAAE,EAAE,CACZC,MAAM,CAAE,EAAE,CACVC,UAAU,CAAE,EAChB,CAAC,CAAC,CACF;AACA;AACJ,CAAC,CAAC,CACDgB,KAAK,CAACC,GAAG,EAAIC,OAAO,CAACC,KAAK,CAAC,kCAAkC,CAAEF,GAAG,CAAC,CAAC,CAC7E,CAAC,CAED,mBACItC,KAAA,QAAK6C,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC5B9C,KAAA,QAAA8C,QAAA,eACIhD,IAAA,OAAI+C,SAAS,CAAC,IAAI,CAAAC,QAAA,CAAC,cAAY,CAAI,CAAC,cACpChD,IAAA,QAAK+C,SAAS,CAAC,IAAI,CAACE,GAAG,CAAErD,KAAM,CAACsD,GAAG,CAAC,OAAO,CAAE,CAAC,EAC7C,CAAC,CAEL7C,OAAO,cACJH,KAAA,SAAMiD,QAAQ,CAAER,YAAa,CAAAK,QAAA,eACzB9C,KAAA,UAAO6C,SAAS,CAAC,OAAO,CAAAC,QAAA,eACpBhD,IAAA,UAAAgD,QAAA,cACI9C,KAAA,OAAA8C,QAAA,eACIhD,IAAA,OAAAgD,QAAA,CAAI,YAAU,CAAI,CAAC,cACnBhD,IAAA,OAAAgD,QAAA,CAAI,QAAM,CAAI,CAAC,cACfhD,IAAA,OAAAgD,QAAA,CAAI,UAAQ,CAAI,CAAC,cACjBhD,IAAA,OAAAgD,QAAA,CAAI,SAAO,CAAI,CAAC,cAChBhD,IAAA,OAAAgD,QAAA,CAAI,MAAI,CAAI,CAAC,cACbhD,IAAA,OAAAgD,QAAA,CAAI,MAAI,CAAI,CAAC,cACbhD,IAAA,OAAAgD,QAAA,CAAI,IAAE,CAAI,CAAC,cACXhD,IAAA,OAAAgD,QAAA,CAAI,MAAI,CAAI,CAAC,cACbhD,IAAA,OAAAgD,QAAA,CAAI,MAAI,CAAI,CAAC,cACbhD,IAAA,OAAAgD,QAAA,CAAI,MAAI,CAAI,CAAC,cACbhD,IAAA,OAAAgD,QAAA,CAAI,KAAG,CAAI,CAAC,cACZhD,IAAA,OAAAgD,QAAA,CAAI,QAAM,CAAI,CAAC,cACfhD,IAAA,OAAAgD,QAAA,CAAI,WAAS,CAAI,CAAC,cAClBhD,IAAA,OAAAgD,QAAA,CAAI,SAAO,CAAI,CAAC,cAChBhD,IAAA,OAAAgD,QAAA,CAAI,aAAW,CAAI,CAAC,EACpB,CAAC,CACF,CAAC,cACRhD,IAAA,UAAAgD,QAAA,cACI9C,KAAA,OAAA8C,QAAA,eACIhD,IAAA,OAAAgD,QAAA,CAAK3C,OAAO,CAACI,EAAE,CAAK,CAAC,cACrBT,IAAA,OAAAgD,QAAA,CAAKzC,QAAQ,CAACG,KAAK,CAAK,CAAC,cACzBV,IAAA,OAAAgD,QAAA,CAAKzC,QAAQ,CAACI,OAAO,CAAK,CAAC,cAC3BX,IAAA,OAAAgD,QAAA,CAAKzC,QAAQ,CAACK,OAAO,CAAK,CAAC,cAC3BZ,IAAA,OAAAgD,QAAA,CAAKzC,QAAQ,CAACM,IAAI,CAAK,CAAC,cACxBb,IAAA,OAAAgD,QAAA,CAAK3C,OAAO,CAACU,IAAI,CAAK,CAAC,cACvBf,IAAA,OAAAgD,QAAA,CAAK3C,OAAO,CAACS,EAAE,CAAK,CAAC,cACrBd,IAAA,OAAAgD,QAAA,CAAKzC,QAAQ,CAACS,IAAI,CAAK,CAAC,cACxBhB,IAAA,OAAAgD,QAAA,CAAK3C,OAAO,CAACY,IAAI,CAAK,CAAC,cACvBjB,IAAA,OAAAgD,QAAA,CAAK3C,OAAO,CAACa,IAAI,CAAK,CAAC,cACvBlB,IAAA,OAAAgD,QAAA,CAAK3C,OAAO,CAACc,GAAG,CAAK,CAAC,cACtBnB,IAAA,OAAAgD,QAAA,CAAK3C,OAAO,CAACe,MAAM,CAAK,CAAC,cACzBpB,IAAA,OAAAgD,QAAA,CAAK3C,OAAO,CAAC+C,MAAM,CAAK,CAAC,cACzBpD,IAAA,OAAAgD,QAAA,CAAK3C,OAAO,CAACgD,IAAI,CAAK,CAAC,cACvBrD,IAAA,OAAAgD,QAAA,CAAKzC,QAAQ,CAACgB,UAAU,CAAK,CAAC,EAC9B,CAAC,CACF,CAAC,EACL,CAAC,cAERvB,IAAA,CAACF,IAAI,EAACgB,EAAE,CAAC,GAAG,CAAAkC,QAAA,cAAChD,IAAA,WAAQsD,KAAK,CAAC,cAAc,CAACC,OAAO,CAAEA,CAAA,GAAMC,MAAM,CAACC,KAAK,CAAC,CAAE,CAChE,CAAC,CAAM,CAAC,EAGd,CAAC,cAEPzD,IAAA,OAAAgD,QAAA,CAAI,YAAU,CAAI,CACrB,EACA,CAAC,CAEd,CAEA,cAAe,CAAA7C,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}